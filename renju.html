<!DOCTYPE HTML>
<html>
<head><title>Test Arena</title>
</head>
<body>
<script src="jquery.js"></script>
<script>	
	var steps = [
		{x: 10, y: 10, color: 0},
		{x: 11, y: 11, color: 1},
		{x: 10, y: 11, color: 0}
	];
	function Button(text,x,y,width,height) {
		this.text = text;
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		this.draw = function() {
			var ctx = document.getElementById("arena").getContext("2d");
			ctx.beginPath();
			// document.getElementById("myoutput").innerHTML = "Text:" + this.text + " draw rect " + this.x + "," + this.y + "," + this.width + "," + this.height;
			ctx.rect(this.x, this.y, this.width, this.height);
			ctx.strokeStyle = "black";
			ctx.stroke();
		};
	}
	
	var nextButton = new Button("Next", 300, 10, 100, 50);
	var prevButton = new Button("Prev", 300, 100, 100, 50);
	
	const SIZE = 20;
	const LEFT = 10, TOP = 10;
	const ROWS = 15, COLS = 15;
	const R = SIZE / 2 - 1;
	
	var preX, preY;

	function drawChess(x, y, color) {
		var ctx = document.getElementById("arena").getContext("2d");
		ctx.beginPath();
		if (color == 0) {
			ctx.fillStyle = "#000000";
		} else {
			ctx.fillStyle = "#FFFFFF";
		}
		ctx.moveTo(LEFT + x * SIZE + R, TOP + y * SIZE);
		ctx.arc(LEFT + x * SIZE, TOP + y * SIZE,
			R, 0, 2 * Math.PI, false);
		ctx.fill();
		ctx.stroke();
	}
	
	function drawCursor(x, y, color) {
		var ctx = document.getElementById("arena").getContext("2d");
		ctx.beginPath();
		ctx.rect(LEFT + x * SIZE - R, TOP + y * SIZE - R, R * 2, R * 2);
		ctx.strokeStyle = color;
		ctx.stroke();
	}

	function paint() {
		var ctx = document.getElementById("arena").getContext("2d");
		ctx.clearRect(0, 0, 800, 600);
		ctx.beginPath();
		ctx.strokeStyle = "black";
		var i;
		for (i = 0 ; i < ROWS ; i++) {
			ctx.moveTo(LEFT, TOP + i * SIZE);
			ctx.lineTo(LEFT + (ROWS-1) * SIZE, TOP + i * SIZE);
			ctx.stroke();
		}
		for (i = 0 ; i < COLS ; i++) {
			ctx.moveTo(LEFT + i * SIZE, TOP);
			ctx.lineTo(LEFT + i * SIZE, TOP + (COLS-1) * SIZE);
			ctx.stroke();
		}
		// putChess(10, 9, 0);
		// putChess(10, 10, 1);
		for (i = 0 ; i < steps.length ; ++i) {
			drawChess(steps[i].x, steps[i].y, steps[i].color);
		}
		drawCursor(Math.round((preX - LEFT) / SIZE),
			Math.round((preY - TOP) / SIZE), "#8ED6FF");
		nextButton.draw();
		prevButton.draw();
	}

	window.onload = function() {
		alert(steps.length)
		paint();
	};
	
	$(document).ready(function() {
		$("#arena").click(function(e) {
			var x = e.pageX - this.offsetLeft;
			var y = e.pageY - this.offsetTop;
			steps.push({"x": Math.round((x-LEFT)/SIZE),
				"y": Math.round((y-TOP) / SIZE),
				"color": 0});
			paint();
			// drawChess(Math.round((x - LEFT) / SIZE),
			// 	Math.round((y - TOP) / SIZE), 0);
		});
		$("#arena").mousemove(function(e) {
			preX = e.pageX - this.offsetLeft;
			preY = e.pageY - this.offsetTop;
			paint();
		});
	});
</script>
<div id="myoutput">blahalbalgdlag</div>
<canvas id="arena" width="800" height="600">
</canvas>
</body>
</html>